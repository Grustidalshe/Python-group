"""
Лабораторна робота 8 (групова)
Тема: Робота з файлами в Python

Програма демонструє роботу з текстовими файлами:
- Створення файлу та запис першого питання
- Додавання відповідей та нових питань
- Читання та виведення вмісту файлу

Виконали: Трубіна, Комісаров
Група: КНЗ-41С
"""

import os

# Назва спільного файлу для групової роботи
FILENAME = "Лабораторна8-групова.txt"


# ==================== Частина Студента 1 (Прізвище: Трубіна) ====================
# Відповідальність: створення файлу та функція запису першого питання

def create_file(student_surname, question):
    """
    Створює новий файл і записує перше питання від студента.
    
    Параметри:
        student_surname (str): прізвище студента
        question (str): питання для наступного студента
    """
    try:
        with open(FILENAME, "w", encoding="utf-8") as f:
            f.write("--------------------------------\n")
            f.write(f"Студент: {student_surname}\n")
            f.write(f"Роль: Питання\n")
            f.write(f"Зміст: {question}\n")
            f.write("--------------------------------\n")
        print(f"Файл успішно створено студентом {student_surname}")
    except PermissionError:
        print("Помилка: відсутній дозвіл на запис у цю папку.")
    except Exception as e:
        print(f"Помилка при створенні файлу: {e}")


def read_file():
    """
    Читає і виводить на екран вміст файлу.
    Перевіряє наявність файлу перед читанням.
    """
    if os.path.exists(FILENAME):
        print("\n---------- ВМІСТ ФАЙЛУ ---------")
        try:
            with open(FILENAME, "r", encoding="utf-8") as f:
                print(f.read())
            print("----------------------------------\n")
        except Exception as e:
            print(f"Помилка при читанні файлу: {e}")
    else:
        print("Помилка: файл ще не створено.")


# ==================== Частина Студента 2 (Прізвище: Комісаров) ====================
# Відповідальність: функція додавання відповідей та головна функція програми

def add_reply(student_surname, answer, next_question):
    """
    Додає відповідь на попереднє питання та нове питання в кінець файлу.
    
    Параметри:
        student_surname (str): прізвище студента
        answer (str): відповідь на попереднє питання
        next_question (str): нове питання для наступного студента
    """
    # Перевірка наявності файлу
    if not os.path.exists(FILENAME):
        print("Помилка: файлу не існує. Спочатку потрібно створити файл.")
        return

    try:
        with open(FILENAME, "a", encoding="utf-8") as f:
            f.write(f"Студент: {student_surname}\n")
            f.write(f"Роль: Відповідь та нове питання\n")
            f.write(f"Відповідь: {answer}\n")
            f.write(f"Наступне питання: {next_question}\n")
            f.write("--------------------------------\n")
        print(f"Відповідь успішно додано студентом {student_surname}")
    except Exception as e:
        print(f"Помилка при додаванні відповіді: {e}")


def main():
    """
    Головна функція програми.
    Демонструє роботу з файлами: створення, запис, читання.
    """
    try:
        # Видалення старого файлу (якщо існує) для чистого запуску
        if os.path.exists(FILENAME):
            os.remove(FILENAME)
            print("Попередній файл видалено.\n")
        
        # --- Студент 1: Трубіна — створює файл та пише питання ---
        create_file(
            student_surname="Трубіна", 
            question="Як відкрити та прочитати файл у Python?"
        )

        # --- Студент 2: Комісаров — дає відповідь і задає нове питання ---
        add_reply(
            student_surname="Комісаров",
            answer="Треба використати конструкцію with open(name, 'r', encoding='utf-8') as f.",
            next_question="Як обробляти помилки (наприклад, якщо файлу немає)?"
        )

        # --- Студент 3: Трубіна — дає відповідь і задає нове питання ---
        add_reply(
            student_surname="Трубіна",
            answer="Для обробки помилок використовують блок try-except.",
            next_question="Як записати список рядків у файл однією командою?"
        )

        # Виведення результату роботи
        read_file()

    except FileNotFoundError:
        print("Помилка: вказаний шлях не існує.")
    except Exception as e:
        print(f"Сталася непередбачена помилка: {e}")


if __name__ == "__main__":
    main()