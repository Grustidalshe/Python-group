"""
Лабораторна робота 6 (групова)
Тема: Робота зі словниками в Python

Словник містить дані про студентів:
- номер групи (КНЗ-41С)
- прізвище, ім'я та по батькові
- курс
- спеціальність (Комп'ютерні науки)
- предмети та оцінки за семестр

Виконали: Трубіна, Комісаров
Група: КНЗ-41С
"""

# ==================== Частина Студента 1 (Прізвище: Трубіна) ====================
# Відповідальність: створення структури даних та функції виведення

# Початковий словник із даними студентів
students = {
    1: {
        'group': "КНЗ-41С",
        'surname': "Коваленко",
        'name': "Федор",
        'patronymic': "Олександрович",
        'course': 2,
        'major': "Комп'ютерні науки",
        'subjects': {'Математика': 88, 'Програмування': 95, 'Фізика': 78}
    },
    2: {
        'group': "КНЗ-41С",
        'surname': "Петрова",
        'name': "Марія",
        'patronymic': "Іванівна",
        'course': 1,
        'major': "Комп'ютерні науки",
        'subjects': {'Математика': 92, 'Програмування': 85, 'Англійська': 90}
    },
    3: {
        'group': "КНЗ-41С",
        'surname': "Левченко",
        'name': "Олена",
        'patronymic': "Сергіївна",
        'course': 2,
        'major': "Комп'ютерні науки",
        'subjects': {'Математика': 72, 'Програмування': 70, 'Англійська': 98}
    }
}


def print_all():
    """
    Виводить на екран всі записи словника у вигляді таблиці.
    Відображає ID, прізвище, ім'я, по батькові, курс, групу та предмети з оцінками.
    """
    print("\nВсі записи словника:")
    print("{:<4} {:<10} {:<10} {:<15} {:<6} {:<23} {:<}".format(
        "ID", "Прізвище", "Ім'я", "По батькові", "Курс", "Група", "Предмети(оцінки)\n"))
    
    for sid, info in students.items():
        subj = ", ".join(f"{k}:{v}" for k, v in info['subjects'].items())
        print(f"{sid:<4} {info['surname']:<10} {info['name']:<10} {info['patronymic']:<15} "
              f"{info['course']:<6} {info['group']:<10} {subj}")


# ==================== Частина Студента 2 (Прізвище: Комісаров) ====================
# Відповідальність: функція додавання студента та головна функція програми

def add_student():
    """
    Додає нового студента до словника.
    Запитує всі необхідні дані у користувача та перевіряє правильність введення.
    Обробляє помилки введення для числових значень.
    """
    try:
        key = int(input("Введіть новий ключ (ID): ").strip())
    except ValueError:
        print("Помилка: невірний формат ключа. Потрібно ціле число.")
        return

    if key in students:
        print("Помилка: ключ вже існує!")
        return

    # Введення особистих даних студента
    surname = input("Прізвище: ").strip()
    name = input("Ім'я: ").strip()
    patronymic = input("По батькові: ").strip()

    try:
        course = int(input("Курс: ").strip())
    except ValueError:
        print("Помилка: невірний формат курсу. Потрібно ціле число.")
        return

    group = input("Група: ").strip()
    major = input("Спеціальність (за замовчуванням 'Комп'ютерні науки'): ").strip() or "Комп'ютерні науки"

    # Введення предметів та оцінок
    subjects = {}
    print("Введіть предмети та оцінки (порожній предмет — завершити):")
    while True:
        subj = input("  Предмет: ").strip()
        if not subj:
            break
        try:
            grade = int(input("  Оцінка (0-100): ").strip())
        except ValueError:
            print("  Помилка: невірна оцінка — пропускаємо цей предмет.")
            continue
        subjects[subj] = grade

    # Додавання нового запису до словника
    students[key] = {
        'group': group,
        'surname': surname,
        'name': name,
        'patronymic': patronymic,
        'course': course,
        'major': major,
        'subjects': subjects
    }
    print(f"Запис додано успішно: {key}: {students[key]}")


def main():
    """
    Головна функція програми.
    Виводить всі записи словника та пропонує додати нового студента.
    """
    try:
        # Виведення всіх студентів
        print_all()

        # --- Додавання нового студента (опціонально) ---
        print("\n" + "=" * 50)
        choice = input("Бажаєте додати нового студента? (так/ні): ").strip().lower()
        
        if choice in ['так', 'yes', 'y', 'т']:
            add_student()
            print("\nОновлений список студентів:")
            print_all()
        else:
            print("Програма завершена.")
        # ------------------------------------------------

    except Exception as e:
        print(f"Сталася непередбачена помилка: {e}")


if __name__ == "__main__":
    main()